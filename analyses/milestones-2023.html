<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lasse Hjorth Madsen">
<meta name="dcterms.date" content="2023-08-29">

<title>Milestones III, 2023</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../analyses/milestones-2023.html">Milestones III, 2023</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/explore-emg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explore EMG Normalization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/met-precision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Match Equity Precision</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/janowski.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Janowski Formulars</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/milestones-2023.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Milestones III, 2023</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#why-this" id="toc-why-this" class="nav-link active" data-scroll-target="#why-this">Why this?</a></li>
  <li><a href="#cube-actions" id="toc-cube-actions" class="nav-link" data-scroll-target="#cube-actions">Cube actions</a>
  <ul class="collapse">
  <li><a href="#position-1" id="toc-position-1" class="nav-link" data-scroll-target="#position-1">Position 1</a></li>
  <li><a href="#position-2" id="toc-position-2" class="nav-link" data-scroll-target="#position-2">Position 2</a></li>
  <li><a href="#position-3" id="toc-position-3" class="nav-link" data-scroll-target="#position-3">Position 3</a></li>
  </ul></li>
  <li><a href="#checker-plays" id="toc-checker-plays" class="nav-link" data-scroll-target="#checker-plays">Checker plays</a>
  <ul class="collapse">
  <li><a href="#position-1-1" id="toc-position-1-1" class="nav-link" data-scroll-target="#position-1-1">Position 1</a></li>
  <li><a href="#positions-2a-2d" id="toc-positions-2a-2d" class="nav-link" data-scroll-target="#positions-2a-2d">Positions 2a-2d</a></li>
  <li><a href="#position-3-1" id="toc-position-3-1" class="nav-link" data-scroll-target="#position-3-1">Position 3</a></li>
  <li><a href="#position-4" id="toc-position-4" class="nav-link" data-scroll-target="#position-4">Position 4</a></li>
  <li><a href="#position-5" id="toc-position-5" class="nav-link" data-scroll-target="#position-5">Position 5</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Milestones III, 2023</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lasse Hjorth Madsen </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 29, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="why-this" class="level2">
<h2 class="anchored" data-anchor-id="why-this">Why this?</h2>
<p>This is a collection of positions from the Milestones III tournament in Denmark, 2023, where players compete for wins and for best performance rating (PR). Every player gets to play 15 7-point matches. I will collect about one problem from each of my own matches: Positions where I made some mistake, that I found difficult, surprising or otherwise interesting.</p>
<p>In some cases, I show also variations, to better understand what is going on. I will organize the positions only into cube actions and checker plays, adding more as they come.</p>
</section>
<section id="cube-actions" class="level2">
<h2 class="anchored" data-anchor-id="cube-actions">Cube actions</h2>
<section id="position-1" class="level3">
<h3 class="anchored" data-anchor-id="position-1">Position 1</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Over the board, this looked to me like a strong double. White has an excellent forward structure, a fat racing lead, and a 4-point prime that can be extended from the back in relative safety, since Black has two checkers on the bar. The only weakness is White’s blot on the ace point, but getting hit is not a big deal, so it can’t be much of a liability.</p>
<p>Meanwhile, Black has made almost no progress; only the 11-point is made.</p>
<p>My guess was a strong double, and a smallish take for Black. It is, however, the other way around: White has only a small double, Black has a huge take:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Cubeful Equities:
       No double:     +0,690 (-0,047)
       Double/Take:   +0,736
       Double/Pass:   +1,000 (+0,264)
1296 Games rolled with Variance Reduction.
Moves: 3-ply, cube decisions: XG Roller</code></pre>
</div>
</div>
<p>Looking at the outcome probabilities, we see that White does have a big gammon threat, but also that Black wins more than a third of the games:</p>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Regular</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gammon</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Backgammon</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Player wins</td>
<td style="text-align: right; width: 3.1cm;">0.292</td>
<td style="text-align: right; width: 3.1cm;">0.340</td>
<td style="text-align: right; width: 3.1cm;">0.024</td>
<td style="text-align: right; width: 3.1cm;">0.656</td>
</tr>
<tr class="even">
<td style="text-align: left;">Opponent wins</td>
<td style="text-align: right; width: 3.1cm;">0.265</td>
<td style="text-align: right; width: 3.1cm;">0.072</td>
<td style="text-align: right; width: 3.1cm;">0.007</td>
<td style="text-align: right; width: 3.1cm;">0.344</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sum</td>
<td style="text-align: right; width: 3.1cm;">0.557</td>
<td style="text-align: right; width: 3.1cm;">0.412</td>
<td style="text-align: right; width: 3.1cm;">0.031</td>
<td style="text-align: right; width: 3.1cm;">1.000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>One thing that I might have overlooked here, is that White has very few real crushing frequencies, because he’s a little short on ammo. Black will almost always make some kind of anchor, and then have some kind of counter play agains White’s three back checkers.</p>
<p>To see if this result is match-score related, let’s check the same position for money, and while we’re at it, also check if XG Roller ++ (fast, truncated rollouts), gets it right, compared to a full rollout at strong settings.</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Cubeful Equities:
       No double:     +0,800 (-0,120)
       Double/Take:   +0,920
       Double/Pass:   +1,000 (+0,080)
1296 Games rolled with Variance Reduction.
Moves: 3-ply, cube decisions: XG Roller

Analyzed in XG Roller++
       No double:     +0,784 (-0,134)
       Double/Take:   +0,918
       Double/Pass:   +1,000 (+0,082)</code></pre>
</div>
</div>
</div>
<p>For money, the double is bigger, and the take is smaller, so more in line with my first impression. It appears that the 2-point lead for White does make a difference.</p>
<p>But why?</p>
<p>The next table shows Black’s takepoints under different assumption: No cube and no gammons (like a last-roll position); no cube and gammon rates from the table above; and finally taking both cube and gammons into account.</p>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Cube assumptions</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Moneygame takepoint</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">7-away, 5-away takepoint</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dead cube, no gammons</td>
<td style="text-align: right; width: 3.5cm;">0.250</td>
<td style="text-align: right; width: 3.5cm;">0.240</td>
<td style="text-align: right; width: 3.5cm;">-0.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dead cube, gammons</td>
<td style="text-align: right; width: 3.5cm;">0.384</td>
<td style="text-align: right; width: 3.5cm;">0.382</td>
<td style="text-align: right; width: 3.5cm;">-0.002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Both cube and gammons</td>
<td style="text-align: right; width: 3.5cm;">0.343</td>
<td style="text-align: right; width: 3.5cm;">0.304</td>
<td style="text-align: right; width: 3.5cm;">-0.039</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The last-roll takepoint is not too different from money at this score, and it also doesn’t make much difference to factor in gammons. When we consider possible recubes, however, we see that Black’s takepoint at the score, is somewhat lower than it would be for money.</p>
<p>This is because he’ll redouble more aggressively at the score. We can see why, by looking at <em>White’s</em> takepoints for a potential recube, assuming the same gammon frequencies:</p>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Cube assumptions</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Moneygame takepoint</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">5-away, 7-away recube takepoint</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dead cube, no gammons</td>
<td style="text-align: right; width: 3.5cm;">0.250</td>
<td style="text-align: right; width: 3.5cm;">0.266</td>
<td style="text-align: right; width: 3.5cm;">0.016</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dead cube, gammons</td>
<td style="text-align: right; width: 3.5cm;">0.264</td>
<td style="text-align: right; width: 3.5cm;">0.333</td>
<td style="text-align: right; width: 3.5cm;">0.069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Both cube and gammons</td>
<td style="text-align: right; width: 3.5cm;">0.236</td>
<td style="text-align: right; width: 3.5cm;">0.312</td>
<td style="text-align: right; width: 3.5cm;">0.076</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>So, it looks like a good part of my flawed evaluation of the original position, comes from the fact that Black can take somewhat more aggressively at the score; hence White needs more to have a really strong double.</p>
<p>The reason for Black’s lower takepoint at the score, lies mostly in the potential redouble in positions where gammons are possible: It’s hard for White to accept a 4-cube at 5-away 7-away, where a gammon loss means is much more costly than a gammon win.</p>
<p>Still, the position is also a clear take for money, so there’s some reconsideration to do in that department too. What will it take to turn the position into a really tough take for money?</p>
<p>If we activate the awkward spare on the ace-point, we suddenly have a big pass. Perhaps not surprising, since the liability turns into a big asset. But still:</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Analyzed in XG Roller++
Cubeful Equities:
       No double:     +0,979 (-0,021)
       Double/Take:   +1,273 (+0,273)
       Double/Pass:   +1,000</code></pre>
</div>
</div>
</div>
<p>Even if we put the spare checker in a less ideal place, we still get a double/pass:</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Analyzed in XG Roller++
Cubeful Equities:
       No double:     +0,929 (-0,071)
       Double/Take:   +1,045 (+0,045)
       Double/Pass:   +1,000</code></pre>
</div>
</div>
</div>
<p>That spare has to move out of the action, to get to a marginal pass:</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Analyzed in XG Roller++
Cubeful Equities:
       No double:     +0,913 (-0,087)
       Double/Take:   +1,011 (+0,011)
       Double/Pass:   +1,000</code></pre>
</div>
</div>
</div>
<p>Finally, we get to a decent take, noting that Black is no longer far behind in the race:</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Analyzed in XG Roller++
Cubeful Equities:
       No double:     +0,874 (-0,072)
       Double/Take:   +0,947
       Double/Pass:   +1,000 (+0,053)</code></pre>
</div>
</div>
</div>
<p>One way to see how bad White’s ace-point blot is, is to consider the original position after something like 31: 24/20. Now, most aces, like 21, 31, 41, and 51, are below-average rolls for Black, even though they hit. White is <em>hoping</em> to get hit (except with 41 and 11, trying for a high anchor); that’s how bad the blot is.</p>
<p>Another experiment would be to improve White’s opportunity to extend the prime from the back. A one-pip change can be huge: We go from a clear take to a pretty clear pass:</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Analyzed in XG Roller++
Cubeful Equities:
       No double:     +0,856 (-0,144)
       Double/Take:   +1,059 (+0,059)
       Double/Pass:   +1,000</code></pre>
</div>
</div>
</div>
<p>Another change in the same spirit is to bring in another builder for that important 9-point. It has about the samme effect as slotting:</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Analyzed in XG Roller++
Cubeful Equities:
       No double:     +0,854 (-0,146)
       Double/Take:   +1,065 (+0,065)
       Double/Pass:   +1,000</code></pre>
</div>
</div>
</div>
<p>A final one-pip change that has a rather dramatic effect, is to just semi-active the ace-point checker so it easier becomes part of a prime, and is both easier and more attractive to cover. Again, we go from a clear take to a clear pass:</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Analyzed in XG Roller++
Cubeful Equities:
       No double:     +0,849 (-0,151)
       Double/Take:   +1,062 (+0,062)
       Double/Pass:   +1,000</code></pre>
</div>
</div>
</div>
<p>Summing up:</p>
<ul>
<li>A two-point lead in a 7-point match matters, especially if you might face a recube when gammons are still possible.</li>
<li>What seems to be a strong positional advantage, might not be so strong if there are also liabilities.</li>
<li>An awkward ace-point blot can be a rather big liability</li>
<li>Small things matter: One pip can make a it much easier to turn a strong position into a winning position.</li>
</ul>
</section>
<section id="position-2" class="level3">
<h3 class="anchored" data-anchor-id="position-2">Position 2</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>This is another example of blitz that could work as a bluff double: It might look like White has a strong blitz going, but in fact the take is easy, and this is not even a double. In practice, it’s not impossible to get a pass. (Okay, I passed this, I admit.)</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Analyzed in XG Roller++
Cubeful Equities:
No double:     +0,579
Double/Take:   +0,534 (-0,045)
Double/Pass:   +1,000 (+0,421)</code></pre>
</div>
</div>
<p>At the match score, the error from passing is gigantic, for money it is smaller but still big:</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Analyzed in XG Roller++
Cubeful Equities:
No double:     +0,664 (-0,078)
Double/Take:   +0,742
Double/Pass:   +1,000 (+0,258)</code></pre>
</div>
</div>
</div>
<p>To better understand why this score is so different from money, we can compare the takepoints for money and at the score, using different assumptions:</p>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Cube assumptions</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Moneygame takepoint</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">7-away, 5-away takepoint</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dead cube, no gammons</td>
<td style="text-align: right; width: 3.5cm;">0.250</td>
<td style="text-align: right; width: 3.5cm;">0.240</td>
<td style="text-align: right; width: 3.5cm;">-0.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dead cube, gammons</td>
<td style="text-align: right; width: 3.5cm;">0.369</td>
<td style="text-align: right; width: 3.5cm;">0.368</td>
<td style="text-align: right; width: 3.5cm;">-0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Both cube and gammons</td>
<td style="text-align: right; width: 3.5cm;">0.330</td>
<td style="text-align: right; width: 3.5cm;">0.288</td>
<td style="text-align: right; width: 3.5cm;">-0.042</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>As in position 1, it is the powerful recube access that makes Black considerable more inclined to take at the score, compare to money game.</p>
<p>Let’s keep the money game variant, and play with features of the position.</p>
<p>The ace-point slots makes all the difference in the world, because it commits White to a blitz. If we turn the slot into a builder White can both blitz or prime, and two strong game plans are much better than one. As a result has a moderate sized pass in the variant below.</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Analyzed in XG Roller++
Cubeful Equities:
No double:     +0,865 (-0,135)
Double/Take:   +1,067 (+0,067)
Double/Pass:   +1,000</code></pre>
</div>
</div>
</div>
<p>Also, making it a bit easier for White to jump his back checkers, turns the position into just a borderline take.</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
Analyzed in XG Roller++
Cubeful Equities:
No double:     +0,784 (-0,211)
Double/Take:   +0,996
Double/Pass:   +1,000 (+0,004)</code></pre>
</div>
</div>
</div>
<p>In summary, it is the combination of having to jump a prime, without being on the edge, <em>and</em> being committed to a blitz, <em>and</em> being a little short on ammunition, that makes Whites’s position weaker than it might appear.</p>
</section>
<section id="position-3" class="level3">
<h3 class="anchored" data-anchor-id="position-3">Position 3</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="384"></p>
</div>
</div>
</div>
</section>
</section>
<section id="checker-plays" class="level2">
<h2 class="anchored" data-anchor-id="checker-plays">Checker plays</h2>
<section id="position-1-1" class="level3">
<h3 class="anchored" data-anchor-id="position-1-1">Position 1</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Here, White has four reasonable options:</p>
<ul>
<li>13/11, 13/8, clearing the midpoint</li>
<li>11/4, placing a spare on the 4-point</li>
<li>11/6, 11/9, with spares on the 6- and 9-points</li>
</ul>
<p>Unwilling to break the midpoint as long as reasonable alternatives existed, White played 11/4, wanting to leave fewer shots and cover more outfield, compared to 11/6, 11/9.</p>
<p>It is not hard to accept that this can be a mistake:</p>
<p>11/6, 11/9 also breaks the 11-point, but is more compact. It adds 63 to build the 3-point, slots the 9-point which could be useful, and only leaves 44 as an extra shot (a joker anyway).</p>
<p>13/11, 13/8, clearing the midpoint, puts full emphasis on White’s all-important 5-point, leaves no shot, and makes it more dangerous for Black to split with a roll like 42.</p>
<p>The interesting part is not that XG picks 13/11, 13/8, but the <em>magnitude</em> of the mistake is remarkable; anything but breaking the midpoint is a blunder:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>XG Roller++ 
1. 13/11 13/8           eq:+0,026
2. 11/9 11/6            eq:-0,065 (-0,090)
3. 11/4                 eq:-0,131 (-0,157)</code></pre>
</div>
</div>
<p>The key is, that after the top-play, 9 rolls make a full 5-prime, after the second best, only 4 rolls do that. Some rolls, 31 and 43, makes the 5-point but breaks the 8, which is not as strong. So the extra builders on the 11- and 8-points have real value.</p>
<p>Note that White should break the 13-point with a lot of rolls: 54, 43, 62, 42, 32, 51, and the 52 from the actual position.</p>
<p>51 deserves special mention, the funny looking 13/7 is probably slightly better than the aggressive slot, 11/5, which accomplishes the same thing, but with a different risk/reward ratio: A lot more shots, and a lot more ways to make the 5-point if missed.</p>
<p>The shots left in the outfield is not the main concern: 43 should be played 13/10 13/9 with lots of builders at the cost of 5 shots; 43: 11/8, 11/7 would be a blunder even though it looks flexible.</p>
<p>Likewise, with 32, 13/11, 13/10 is a lot better than 11/9, 11/8, since it creates four active builders for the 5-point rather than just three.</p>
<p>Summing up, making the 5-point and a 5-point-prime is likely to win the game, and White can easily afford to break the midpoint and leave a few fly-shots to increase the probability of achieving that goal.</p>
<p>Builders win out – <em>if</em> they aim at something important, and <em>if</em> they are not too likely to get hit.</p>
</section>
<section id="positions-2a-2d" class="level3">
<h3 class="anchored" data-anchor-id="positions-2a-2d">Positions 2a-2d</h3>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="384"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-25-4.png" class="img-fluid" width="384"></p>
</div>
</div>
</div>
<p>These four positions share a common theme: The right play is hard to find for those of us who learned, back in the day, that the one thing you must never do in backgammon, is to make the ace-point.</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>Position 2a
XG Roller++ 
1. 5/1* 3/1     eq:+0,266
2. 8/6 5/1*     eq:+0,215 (-0,051)
3. 7/1*         eq:+0,204 (-0,062)</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>Position 2b
XG Roller++ 
1. 6/1* 2/1     eq:-0,324
2. 8/7 6/1*     eq:-0,361 (-0,037)
3. 24/23 6/1*   eq:-0,413 (-0,089)</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>Position 2c
XG Roller++ 
1. 8/6 2/1      eq:+0,178
2. 8/5          eq:+0,130 (-0,048)</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>Position 2d
XG Roller++ 
1. 16/1         eq:+0,767
2. 8/3*         eq:+0,754 (-0,013)
3. 9/5 6/5      eq:+0,723 (-0,044)</code></pre>
</div>
</div>
</div>
<p>In both cases White must hit, he has the stronger board and while it is not good to get hit back, Black can also do some damage if left alone.</p>
<p>After hitting on the ace point, anything but switching point just leave another blot for no particular gain.</p>
</section>
<section id="position-3-1" class="level3">
<h3 class="anchored" data-anchor-id="position-3-1">Position 3</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>This is a technical play, where it is tempting to assume that all reasonable plays are close. Actually, they are not so close.</p>
<p>Obviously the play is all about getting off the gammon. Over the board, White played 19/9, thinking that it hardly mattered, as long as he made crossovers and avoided wastage by playing past the 6-point.</p>
<p>The gammon race is close. The probabilities that White will lose a gammon after the five best plays, are listed below.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>1. 13/7 10/6    53.93% 
2. 19/13 10/6   55.07%
3. 19/15 13/7   56.63%
4. 19/9         57.74%
5. 13/9 13/7    58,07%
1296 Games rolled with Variance Reduction.
Moves: 3-ply, cube decisions: XG Roller</code></pre>
</div>
</div>
<p>The actual play, 19/9, increases the risk of getting gammoned, by almost 4 percentage points, so for money that would be about a 0.04 mistake, costing 4 percent of the cube value – a significant mistake.</p>
<p>Why so much?</p>
<p>The main concept in getting-off-the-gammon problems is to avoid “wasting” pips, by playing past the 6-point, those pips don’t help saving the gammon. Playing 10/4 with the 4 does just that, so must be right. Indeed, 10/4 is part of both top plays.</p>
<p>This <em>is</em> quite important, especially when the gammon race is close.</p>
<p>After 10/6 with the 4, 13/7 is best with the 6, simply because it creates a smaller stack: Two checkers on the 7- and 13-point, is better than one and four checkers.</p>
</section>
<section id="position-4" class="level3">
<h3 class="anchored" data-anchor-id="position-4">Position 4</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>This one is from the same game as position 3, but Black has rolled well, so White is now a big favorite to get gammoned. The 31 White has to play is a little funny, because the correct play seem to violate basic principles for getting off the gammon: Make crossovers; don’t waste pips.</p>
<p>The right play is 8/7 8/5, wasting a pip and failing to make two crossovers.</p>
<p>A little reflection shows that White needs to cater to specific doubles. After any play White needs 7 or 8 crossovers in three rolls, so one of roll has to be a double to save the gammon. After 8/7 8/5 any double makes 4 crossover, which is not true for the other plays, so that is the winner.</p>
<p>It’s true, that if White makes two crossovers now, with 13/11 8/5, he only needs to generate three crossovers from future double. But 11 fails to do even that, so it loses a tiny bit there.</p>
<p>The other two-crossover play, 20/17 13/12, also fails on 11, but plays worse on 55 and 44 as well.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>1. 8/7 8/5     89,63% 
2. 13/12 8/5    89,78% 
3. 20/19 8/5    90,42% 
4. 8/4          90,99% 
5. 20/16        91,03% 
6. 20/19 13/10  91,09% 
7. 20/17 13/12  91,39% 
1296 Games rolled with Variance Reduction.
Moves: 3-ply, cube decisions: XG Roller</code></pre>
</div>
</div>
</section>
<section id="position-5" class="level3">
<h3 class="anchored" data-anchor-id="position-5">Position 5</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>This is a tough play. White has two reasonable but very different plays: Hitting with 24/18*/14, or priming with 13/7 11/7.</p>
<p>Hitting has big upsides and big downsides. Black hits back on fully 18 rolls, but also has some bad rolls, 4 dancing rolls, and an additional 8 bad sixes. Some hitting rolls, like 51, aren’t too happy either.</p>
<p>Priming could work, since White is behind in the race. It leaves Black a few immediate horror rolls, 55 and 44, but also some pretty strong hitting aces.</p>
<p>In the end, priming comes out slightly better:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>1. 13/7 11/7          eq:+0,417
2. 24/18* 18/14       eq:+0,401 (-0,016)
3. 24/18* 11/7        eq:+0,239 (-0,178)</code></pre>
</div>
</div>
<p>Let’s have a look at the moneygame variant, together with a very minimal one-pip modification:</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="384"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>XG Roller++ 
1. 13/7 11/7          eq:+0,413
2. 24/18* 18/14       eq:+0,405 (-0,008)</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>XG Roller++ 
1. 24/18* 18/14       eq:+0,367
2. 13/7 11/7          eq:+0,343 (-0,024)</code></pre>
</div>
</div>
</div>
<p>For money priming is still right, but now super close; the two plays are basically a photo finish.</p>
<p>But why the (small) difference compare to 7-away, 7-away score? The reason is, that the hitting play loses a bit more gammons than the priming play. At the score, the gammon value with the cube at two is 0.54, compare to 0.5 for money, so gammons are slightly more costly. For that reason, the hit is a bit more attractive for money, making the two plays even closer.</p>
<p>The real mystery, however, is the variation on the right, where one Black checker from the 5-point has moved back a pip to the 6-point. This seemingly very minor modification makes the hitting play correct by a small but a meaningful amount: 0.024.</p>
<p>The reason is, probably, that the change is not so small after all. Note that the equities in the second position are quite a bit lower, so White is significantly worse off. For that reason, there’s a bit less to lose, when the hitting play backfires.</p>
<p>Also, and perhaps more importantly, in a priming battle Black can use the extra spare on the 6-point to play future 4s, since that number is blocked on the other side of the board. For example, imagine White makes the priming play in both variations, and Black then rolls 54, making the 2-point. Now, the position with two spares on the 5-point really looks a lot worse than the variant with a spare on each of the 5- and 6-point. (And it is, evaluations confirm.)</p>
<p>Bottom line is that Black is better set-up for priming in the right-hand position, so White should chose another gameplan.</p>
<p>Small differences often are not so small.</p>
<p>Let’s do one more exercise with this position, and look at how a few analogous problems evaluate:</p>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
XG Roller++ 
1. 13/7 8/7           eq:+0,394
2. 24/23 24/18*       eq:+0,367 (-0,027)
3. 24/18* 18/17       eq:+0,327 (-0,067)
4. 24/18* 11/10       eq:+0,314 (-0,080)</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
XG Roller++ 
1. 13/7 9/7           eq:+0,411
2. 24/18* 18/16       eq:+0,302 (-0,109)
3. 9/3 5/3            eq:+0,290 (-0,121)</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="milestones-2023_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid" width="384"></p>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<pre><code>
XG Roller++ 
1. 24/21 24/18*       eq:+0,427
2. 13/7 10/7          eq:+0,413 (-0,015)</code></pre>
</div>
</div>
</div>
<p>With a 61 to play, rather that a 64, priming performs better. Not so much because priming is better with 61, but because the alternative hitting plays are all worse than the hit-and-run-almost-home play available with 64.</p>
<p>In the second variation, with the same kind of choice for a roll of 62, priming is now a stand-out. Both because hitting and running still doesn’t run as far, <em>and</em> (I think more importantly) because hitting leaves an additional 2 very dangerous returns from the bar: 63 and 54.</p>
<p>In the final variation, hitting is slightly right, likely because the 10-point would be valuable to make also, so that checkers works also as a slot. (Which may be covered with a 5 from the 15-point.)</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>